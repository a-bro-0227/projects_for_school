scale_fill_brewer()
map.states %>%
ggplot(aes(x = long, y = lat)) +
geom_path(aes(group = group)) +    #for boarders
geom_polygon(aes(group = group,    #for fill
fill = Flu.Cases)) +    #what to fill
ggthemes::theme_map() +
scale_fill_discrete()
map.states %>%
ggplot(aes(x = long, y = lat)) +
geom_path(aes(group = group)) +    #for boarders
geom_polygon(aes(group = group,    #for fill
fill = Flu.Cases)) +    #what to fill
ggthemes::theme_map() +
scale_fill_continuous()
map.states %>%
ggplot(aes(x = long, y = lat)) +
geom_path(aes(group = group)) +    #for boarders
geom_polygon(aes(group = group,    #for fill
fill = Flu.Cases)) +    #what to fill
ggthemes::theme_map() +
scale_fill_continuous(palette = "Purples")
map.states %>%
ggplot(aes(x = long, y = lat)) +
geom_path(aes(group = group)) +    #for boarders
geom_polygon(aes(group = group,    #for fill
fill = Flu.Cases)) +    #what to fill
ggthemes::theme_map() +
scale_fill_gradient2(palette = "Purples")
map.states %>%
ggplot(aes(x = long, y = lat)) +
geom_path(aes(group = group)) +    #for boarders
geom_polygon(aes(group = group,    #for fill
fill = Flu.Cases)) +    #what to fill
ggthemes::theme_map()
library(rvest)
library(xml2)
library(rvest)
rm(list = ls())
library(xml2)
library(rvest)
url <- "http://www.realclearpolitics.com/epolls/2016/president/us/general_election_trump_vs_clinton-5491.html"
tables <- html_table(doc)
doc <- read_html(url)
tables <- html_table(doc)
str(tables)
raw <- tables[[4]]
head(raw)
library(tidyr)
clean01 <- raw %>% separate(Date, into = c("Start_Date", "End_Date"), sep = " - ")
glimpse(polls)
library(tidyverse)
clean01 <- raw %>% separate(Date, into = c("Start_Date", "End_Date"), sep = " - ")
glimpse(polls)
clean02 <- clean01 %>%
mutate(Start_Date = ymd(paste("2016", Start_Date, sep = "/")),
End_Date = ymd(paste("2016", End_Date, sep = "/")))
library(lubridate)
clean02 <- clean01 %>%
mutate(Start_Date = ymd(paste("2016", Start_Date, sep = "/")),
End_Date = ymd(paste("2016", End_Date, sep = "/")))
clean01 <- raw %>% separate(Date, into = c("Start_Date", "End_Date"), sep = " - ")
clean02 <- clean01 %>%
mutate(Start_Date = ymd(paste("2016", Start_Date, sep = "/")),
End_Date = ymd(paste("2016", End_Date, sep = "/")))
View(clean02)
url <- "http://www.realclearpolitics.com/epolls/2016/president/us/general_election_trump_vs_clinton-5491.html"
doc <- read_html(url)
tables <- html_table(doc)
str(tables)
raw <- tables[[4]]
head(raw)
clean01 <- raw %>% separate(Date, into = c("Start_Date", "End_Date"), sep = " - ")
clean02 <- clean01 %>%
mutate(Start_Date = ymd(paste("2016", Start_Date, sep = "/")),
End_Date = ymd(paste("2016", End_Date, sep = "/")))
class(clean02$Start_Date)
polls <- clean02 %>%
separate(Sample, into = c("N", "Type")) %>%
filter(Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`)
clean02 <- clean01 %>%
mutate(Start_Date = ymd(paste("2016", Start_Date, sep = "/")),
End_Date = ymd(paste("2016", End_Date, sep = "/")))
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "right") %>%
filter(Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`)
clean02 <- clean01 %>%
mutate(Start_Date = ymd(paste("2016", Start_Date, sep = "/")),
End_Date = ymd(paste("2016", End_Date, sep = "/")))
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "right") %>%
filter(Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N))
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "right") %>%
filter(Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`)
View(clean02)
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "right") %>%
filter(Poll != c("Final Results", "RCP Average")) %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`)
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "right") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`)
View(polls)
?separate
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average")
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster))
View(polls)
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N),
pollster = ifelse(N <= 5, "Other",
sub(paste0("^(.*?", substr(Poll, 1, 3),".*?)",
substr(Poll, 1, 3), ".*", "\\1",
Poll))))
substr(Poll, 1, 3)
substr(clean02$Poll, 1, 3)
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N),
pollster = ifelse(N <= 5, "Other",
sub(paste0("^(.*?", substr(Poll, 1, 3),".*?)",
substr(Poll, 1, 3), ".*"),
"\\1", Poll)))
View(polls)
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N),
pollster = ifelse(N <= 5, "Other",
sub(paste0("^(.*?", substr(clean02$Poll, 1, 3),".*?)",
substr(clean02$Poll, 1, 3), ".*"),
"\\1", clean02$Poll)))
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N),
pollster = ifelse(N <= 5, "Other",
sub(paste0("^(.*?", substr(Poll, 1, 3),".*?)",
substr(Poll, 1, 3), ".*"),
"\\1", Poll)))
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N),
pollster = ifelse(N <= 5, "Other",
gsub(paste0("^(.*?", substr(Poll, 1, 3),".*?)",
substr(Poll, 1, 3), ".*"),
"\\1", Poll)))
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N),
pollster = gsub(paste0("^(.*?", substr(Poll, 1, 3),".*?)", substr(Poll, 1, 3), ".*"), "\\1", Poll))
paste0("^(.*?", substr(Poll, 1, 3),".*?)", substr(Poll, 1, 3), ".*")
paste0("^(.*?", substr(clean02$Poll, 1, 3),".*?)", substr(clean02$Poll, 1, 3), ".*")
polls <- clean02 %>%
separate(Sample, into = c("N", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
mutate(N = as.numeric(N),
pollster = lapply(Poll, function(x) gsub(paste0("^(.*?", substr(x, 1, 3),".*?)", substr(x, 1, 3), ".*"), "\\1", x)))
polls <- clean02 %>%
separate(Sample, into = c("Number", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
add_count(Poll) %>%
mutate(Number = as.numeric(Number),
pollster = ifelse(n <=5, "Other",
lapply(Poll, function(x) gsub(paste0("^(.*?",
substr(x, 1, 3),".*?)",
substr(x, 1, 3), ".*"),
"\\1", x))))
View(polls)
levels(as.factor(polls$pollster))
polls <- clean02 %>%
separate(Sample, into = c("Number", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
add_count(Poll) %>%
mutate(Number = as.numeric(Number),
pollster = ifelse(n <=5, "Other",
sapply(Poll, function(x) gsub(paste0("^(.*?",
substr(x, 1, 3),".*?)",
substr(x, 1, 3), ".*"),
"\\1", x))))
levels(as.factor(polls$pollster))
polls <- clean02 %>%
separate(Sample, into = c("Number", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
add_count(Poll) %>%
mutate(Number = as.numeric(Number),
pollster = ifelse(n <=5, "Other",
sapply(Poll, function(x) gsub(paste0("^(.*?",
substr(x, 1, 3),".*?)",
substr(x, 1, 3), ".*"),
"\\1", x)))) %>% select(-n)
library(xml2)
library(rvest)
library(tidyverse)
library(lubridate)
url <- "http://www.realclearpolitics.com/epolls/2016/president/us/general_election_trump_vs_clinton-5491.html"
doc <- read_html(url)
tables <- html_table(doc)
str(tables)
# Relevant information is in table # 4
# now we need to clean the data
raw <- tables[[4]]
head(raw)
clean01 <- raw %>% separate(Date, into = c("Start_Date", "End_Date"), sep = " - ")
clean02 <- clean01 %>%
mutate(Start_Date = ymd(paste("2016", Start_Date, sep = "/")),
End_Date = ymd(paste("2016", End_Date, sep = "/")))
polls <- clean02 %>%
separate(Sample, into = c("Number", "Type"), fill = "left") %>%
filter(Poll != "Final Results" & Poll != "RCP Average") %>%
rename(Clinton = `Clinton (D)`, Trump = `Trump (R)`) %>%
add_count(Poll) %>%
mutate(Number = as.numeric(Number),
pollster = ifelse(n <=5, "Other",
sapply(Poll, function(x) gsub(paste0("^(.*?",
substr(x, 1, 3),".*?)",
substr(x, 1, 3), ".*"),
"\\1", x)))) #%>% select(-n)
levels(as.factor(polls$pollster))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster))
head(polls)
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) %>%
geom_point() +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom")
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
geom_point() +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom")
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
ylim(c(-15, 15))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_segment(x = Start_Date, xend = End_Date, yend = Clinton - Trump) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
ylim(c(-15, 15))
View(polls)
colnames(polls)
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_segment(x = Start_Date, xend = End_Date, yend = Clinton - Trump) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
ylim(c(-15, 15))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_segment(aes(x = Start_Date, xend = End_Date, yend = Clinton - Trump)) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
ylim(c(-15, 15))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
annotate("text", x = min(polls$Start_Date), y = 10, label = "Clinton",
size = 20, colour = "grey90", hjust = 0) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_segment(aes(x = Start_Date, xend = End_Date, yend = Clinton - Trump)) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
ylim(c(-15, 15))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
annotate("text", x = min(polls$Start_Date), y = 10, label = "Clinton",
size = 20, colour = "grey90", hjust = 0) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_segment(aes(x = Start_Date, xend = End_Date, yend = Clinton - Trump)) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
theme_bw() +
ylim(c(-15, 15))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
annotate("text", x = min(polls$Start_Date), y = 10, label = "Clinton",
size = 20, colour = "grey90", hjust = 0) +
annotate("text", x = min(polls$Start_Date), y = -10, label = "Trump",
size = 20, colour = "grey90", hjust = 0) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_segment(aes(x = Start_Date, xend = End_Date, yend = Clinton - Trump)) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
theme_bw() +
ylim(c(-15, 15))
library(lubridate)
important_dates <- data.frame(date = ymd(c("2016-11-09", "2016-09-26", "20116-10-09", "2016-10-19",
"2016-07-15", "2016-07-25", "2016-07-18", "2016-07-28")),
typ = c("Election Day", "1st Debate", "2nd Debate", "3rd Debate",
"RNC Start", "DNC Start", "RNC End", "DNC End"))
important_dates <- data.frame(date = ymd(c("2016-11-09", "2016-09-26", "20116-10-9", "2016-10-19",
"2016-07-15", "2016-07-25", "2016-07-18", "2016-07-28")),
typ = c("Election Day", "1st Debate", "2nd Debate", "3rd Debate",
"RNC Start", "DNC Start", "RNC End", "DNC End"))
View(important_dates)
important_dates <- data.frame(date = ymd(c("2016-11-09", "2016-09-26", "2016-10-09", "2016-10-19",
"2016-07-15", "2016-07-25", "2016-07-18", "2016-07-28")),
typ = c("Election Day", "1st Debate", "2nd Debate", "3rd Debate",
"RNC Start", "DNC Start", "RNC End", "DNC End"))
important_dates <- data.frame(date = ymd(c("2016-11-09", "2016-09-26", "2016-10-09", "2016-10-19",
"2016-07-15", "2016-07-25", "2016-07-18", "2016-07-28")),
type = c("Election Day", "1st Debate", "2nd Debate", "3rd Debate",
"RNC Start", "DNC Start", "RNC End", "DNC End"))
polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
annotate("text", x = min(polls$Start_Date), y = 10, label = "Clinton",
size = 20, colour = "grey90", hjust = 0) +
annotate("text", x = min(polls$Start_Date), y = -10, label = "Trump",
size = 20, colour = "grey90", hjust = 0) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_vline(aes(xintercept = as.numeric(date)), colour = "grey80", data = important_dates) +
geom_segment(aes(x = Start_Date, xend = End_Date, yend = Clinton - Trump)) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
theme_bw() +
ylim(c(-15, 15))
k <- levels(polls$pollster)
k <- length(levels(polls$pollster))
brewer.pal(n = k-1, name = "Paired")
library(RColorBrewer)
brewer.pal(n = k-1, name = "Paired")
k <- length(levels(as.factor(polls$pollster)))
brewer.pal(n = k-1, name = "Paired")
p <- polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
annotate("text", x = min(polls$Start_Date), y = 10, label = "Clinton",
size = 20, colour = "grey90", hjust = 0) +
annotate("text", x = min(polls$Start_Date), y = -10, label = "Trump",
size = 20, colour = "grey90", hjust = 0) +
geom_point() +
geom_hline(yintercept = 0, colour = "grey80") +
geom_vline(aes(xintercept = as.numeric(date)), colour = "grey80", data = important_dates) +
geom_segment(aes(x = Start_Date, xend = End_Date, yend = Clinton - Trump)) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
theme_bw() +
ylim(c(-15, 15))
install.packages("ggrepel")
p + ggrepel::geom_label_repel(aes(x = date, label = type), colour = "grey90", y = -13, data = important_dates)
p <- polls %>%
ggplot(aes(x = End_Date, y = Clinton - Trump, colour = pollster)) +
annotate("text", x = min(polls$Start_Date), y = 10, label = "Clinton",
size = 20, colour = "grey90", hjust = 0) +
annotate("text", x = min(polls$Start_Date), y = -10, label = "Trump",
size = 20, colour = "grey90", hjust = 0) +
geom_point() +
geom_smooth(colour = "grey50", se = F) +
geom_hline(yintercept = 0, colour = "grey80") +
geom_vline(aes(xintercept = as.numeric(date)), colour = "grey80", data = important_dates) +
geom_segment(aes(x = Start_Date, xend = End_Date, yend = Clinton - Trump)) +
xlab("Date") +
ylab("Percentage Point Diff") +
theme(legend.position = "bottom") +
theme_bw() +
ylim(c(-15, 15))
p + ggrepel::geom_label_repel(aes(x = date, label = type), colour = "grey90", y = -13, data = important_dates)
library(plotly)
ggplotly(p)
install.packages("xtable")
ggplotly(p)
library(dplyr)
fars <- src_sqlite("fars2014")
accidents <- tbl(fars, "accidents")
fars <- src_sqlite("fars2014")
fars
fars <- src_sqlite("www-fars.nhtsa.dot.gov/Main/index.aspx,")
fars <- src_sqlite("F:/School/ISU/Visual Business Analytics/Data and Markdown files/Related Materials week 12/fars2014")
fars
accidents <- tbl(fars, "accidents")
accidents %>% filter(between(LONGITUD, -130, 0))
accidents %>%
filter(between(LONGITUD, -130, 0)) %>%
collect() %>%
ggplot(aes(LONGITUD, LATITUDE)) +
geom_point(alpha = 0.5, size = 0.5)
library(ggplot2)
accidents %>%
filter(between(LONGITUD, -130, 0)) %>%
collect() %>%
ggplot(aes(LONGITUD, LATITUDE)) +
geom_point(alpha = 0.5, size = 0.5)
accidents <- accidents %>% collect()
View(accidents)
accidents %>% sum(DRUNK_DR)
class(accidents$DRUNK_DR)
accidents %>% group_by(DAY_WEEK, HOUR, DRUNK_DR) %>% summarize(COUNT_ACCIDENTS = n())
library(tidyr)
accidents %>% group_by(DAY_WEEK, HOUR, DRUNK_DR) %>% summarize(COUNT_ACCIDENTS = n()) %>% spread(key = DRUNK_DR, value = COUNT_ACCIDENTS)
accidents %>% group_by(DAY_WEEK, HOUR, DRUNK_DR) %>% summarize(COUNT_ACCIDENTS = n()) %>% spread(key = DRUNK_DR, value = COUNT_ACCIDENTS) %>% data.frame()
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n())
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
unite("DAY_WEEK-HOUR", DAY_WEEK, HOUR, sep = "-")
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
unite("DAY_WEEK-HOUR", DAY_WEEK, HOUR, sep = "-") %>%
ggplot(aes(x = DAY_WEEK-HOUR, y = COUNT_ACCIDENTS, colour = ALCOHOL)) +
geom_line()
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
unite("DAY_WEEK_HOUR", DAY_WEEK, HOUR, sep = "_") %>%
ggplot(aes(x = DAY_WEEK_HOUR, y = COUNT_ACCIDENTS, colour = ALCOHOL)) +
geom_line()
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
unite("DAY_WEEK_HOUR", DAY_WEEK, HOUR, sep = "_") %>%
ggplot(aes(x = DAY_WEEK_HOUR, y = COUNT_ACCIDENTS, colour = ALCOHOL)) +
geom_bar(stat = "identity")
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
# group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
# unite("DAY_WEEK_HOUR", DAY_WEEK, HOUR, sep = "_") %>%
ggplot(aes(x = DAY_WEEK_HOUR, fill = ALCOHOL)) +
geom_bar(position = "fill")
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
# group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
unite("DAY_WEEK_HOUR", DAY_WEEK, HOUR, sep = "_") %>%
ggplot(aes(x = DAY_WEEK_HOUR, fill = ALCOHOL)) +
geom_bar(position = "fill")
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
# group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
unite("DAY_WEEK_HOUR", DAY_WEEK, HOUR, sep = "_") %>%
ggplot(aes(x = DAY_WEEK, y = HOUR, fill = ALCOHOL)) +
geom_bar(position = "fill")
accidents %>% mutate(ALCOHOL = ifelse(DRUNK_DR > 0, "Y", "N")) %>%
# group_by(DAY_WEEK, HOUR, ALCOHOL) %>% summarize(COUNT_ACCIDENTS = n()) %>%
# unite("DAY_WEEK_HOUR", DAY_WEEK, HOUR, sep = "_") %>%
ggplot(aes(x = DAY_WEEK, y = HOUR, fill = ALCOHOL)) +
geom_bar(position = "fill")
rm(list = ls())
library(dplyr)
library(ggplot2)
library(tidyr)
fars <- src_sqlite("F:/School/ISU/Visual Business Analytics/Data and Markdown files/Related Materials week 12/fars2014")
fars
accidents <- tbl(fars, "accidents")
accidents %>% filter(between(LONGITUD, -130, 0))
accidents %>%
filter(between(LONGITUD, -130, 0)) %>%
collect() %>%
ggplot(aes(LONGITUD, LATITUDE)) +
geom_point(alpha = 0.5, size = 0.5)
accidents <- accidents %>% group_by(DAY_WEEK, HOUR, DRUNK_DR) %>% summarize(COUNT_ACCIDENTS = n()) %>% collect()
accidents <- tbl(fars, "accidents")
acc.summ <- accidents %>% group_by(DAY_WEEK, HOUR, DRUNK_DR) %>% summarize(COUNT_ACCIDENTS = n()) %>% collect()
acc.summ <- acc.summ %>% mutate(ALCOHOL = DRUNK_DR > 0)
acc.summ %>%
ggplot(aes(x = HOUR, y = COUNT_ACCIDENTS, colour = ALCOHOL)) +
geom_point()
acc.summ <- acc.summ %>% mutate(ALCOHOL = DRUNK_DR > 0) %>% filter(HOUR <= 24)
acc.summ %>%
ggplot(aes(x = HOUR, y = COUNT_ACCIDENTS, colour = ALCOHOL)) +
geom_point()
acc.summ %>%
ggplot(aes(x = HOUR, y = COUNT_ACCIDENTS, colour = ALCOHOL)) +
geom_point() +
facet_wrap( ~ DAY_WEEK)
