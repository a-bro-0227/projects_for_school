{
    "collab_server" : "",
    "contents" : "install.packages(\"janitor\")\nlibrary(janitor)\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\ndata = read_excel('C://Users/Sarah Diercks/Desktop/StatFinalProj/week18_dallas_animals.xlsx')\n\n#date didn't import correctly\nas.Date(data$outcome_date, format = \"%Y-%m-%d\")\n\n#import date\ndata$outcome_date = suppressWarnings(as.numeric(as.character(data$outcome_date)))\n\n#make date from excel\ndata=data%>%\n  mutate(outcomeDate = excel_numeric_to_date(outcome_date))\n\n#create date difference\ndata$dayDiff = difftime(data$outcome_date, data$intake_date, units = \"days\")\n\ndata$diffTime = NULL\n\n#look at variables and types\nglimpse(data)\n\n#create diff time column \ndata=data%>%\n  mutate(diffTime = difftime(outcomeDate, intake_date,\n         units = \"days\"))\n\ndata$diffTime = as.integer(data$diffTime)\ndata$diffTime1 = factor(data$diffTime)\n\n#only look at dogs\ndallas_dogs <- data %>% filter(animal_type == \"DOG\")\ndallas_dogs$diffTime2 = as.integer(dallas_dogs$diffTime2)\nglimpse(dallas_dogs)\n\n#time at shelter by breed - top 10\ndallas_dogs %>%\n  count(animal_breed) %>%\n  top_n(n = 10, wt = n) %>%\n  ggplot(aes(x = diffTime1, y = n), color = animal_breed, inherit.aes = FALSE) +\n  geom_line(stat = \"identity\") +             #create a bar graph\n  geom_text(aes(label = comma(n)),          #add labels to the graph with a 1,000's comma\n            position = position_dodge(0.9),\n            vjust = -0.1) +\n  ggtitle(\"Top 10 Dog Breed Intake\") +\n  xlab(\"Animal Breed\") +\n  ylab(\"Number of Animals\") +\n  theme(plot.title = element_text(face=\"bold\"),\n        axis.text.x = element_text(angle = 90))\n\n#dallas_dogs$diffTime1 = as.factor(dallas_dogs$diffTime)\n\n#make diffTime a number\ndallas_dogs$diffTime2 = as.numeric(dallas_dogs$diffTime)\ndallas_dogs$diffTime = as.integer((dallas_dogs$diffTime))\nglimpse(dallas_dogs)\n\n#filter to top 10 dogs\ndallas_dogsSub = dallas_dogs%>%\n  filter(animal_breed == \"ALASKAN HUSKY\" |animal_breed == \"BOXER\" | animal_breed == \"CAIRN TERRIER\"|\n         animal_breed == \"CHIHUAHUA SH\"| animal_breed == \"DACHSHUND\"| animal_breed == \"GERM SHEPHERD\"|\n         animal_breed == \"LABRADOR RETR\"| animal_breed == \"PIT BULL\"| animal_breed == \"ROTTWEILER\"|\n         animal_breed == \"SHIH TZU\")\n\n#adds count to data\nadoption1 = dallas_dogs%>%\n  group_by(animal_breed)%>%\n  mutate(count = n())\n\n#filters to adopted animals only\nadoption1 = adoption1 %>%\n  filter(outcome_type == \"ADOPTION\")\n\n#adds count of adopted\nadoption1 = adoption1 %>%\n  group_by(animal_breed) %>%\n  mutate(countAdopt = n())\n\n#add percentage of breed intake / adopted\nadoption1 = adoption1 %>%\n  group_by(animal_breed)%>%\n  mutate(ratio = countAdopt/count)\n\n#since some breedss have only had an intake of 1 it doesn't make sense to study them.\n#I filtered the adoption data to only those that had more than 50 intake\nadoptRatioFilter = adoption1 %>%\n  filter(count>=30)\n\n#redo ratio -- don't htink this is needed\nadoptRatioFilter = adoptRatioFilter%>%\n  group_by(animal_breed)%>%\n  mutate(ratio = countAdopt/count)\n\n#Wwhat's interesting here is that on the far side you see that a low time at the shelter seems to correlate\n#with the high ratio of adopted to number taken in, but when you look at the right side, there also appears to\n#be a low time at the shetler, but a poor adoption rate. \n\n#change to only color top 10 that were adopted\n#copmare to bottom 10\n\nadoptRatioFilter$diffTimeNum = as.numeric(adoptRatioFilter$diffTime)\n\nadoptRatioFilter%>%\n  ggplot(aes(x = ratio, y = diffTimeNum, color = animal_breed), group=group)+\n  geom_point()\n\na = a %>%\n  group_by(animal_breed)%>%\n  summarise(maxRatio = max(ratio))%>%\n  arrange(desc(maxRatio))\n\nb = head(a,n=10)\n\n#if dog was adopted...how long did it take, by breed\n#add color to top 10 breeds\nadoption %>%\n  ggplot(aes(x = meanDiff, y = count))+\n  geom_point()+\n  geom_text(aes(label = animal_breed))\n\n#add time it was at the shelter\ndogs = dallas_dogsSub%>%\n  group_by(animal_breed)%>%\n  mutate(meanDiff = mean(diffTime2))\n\n#plot breed vs mean time at shelter\ndogs %>%\n  ggplot(aes(x = animal_breed, y = meanDiff)) +\n  geom_point(stat = \"identity\")\n\n#Top 10 dogs (count) and mean time at shelter\ndogs %>%\n  ggplot(aes(x = animal_breed, y = meanDiff)) +\n  geom_point(stat = \"identity\") +             \n  ggtitle(\"Top 10 Dog Time at Shelter\") +\n  xlab(\"Animal Breed\") +\n  ylab(\"Mean Time at Shelter\") +\n  theme(plot.title = element_text(face=\"bold\"),\n        axis.text.x = element_text(angle = 90))\n\ndallas_dogsSub %>%\n  group_by(animal_breed)\n\n#shows top 10 breeds, and their outcomes, by outcome\n#Keep - maybe change layout\ndogs%>%\n  ggplot(aes(x = outcome_type, y = diffTime2, color = animal_breed))+\n  geom_point() +\n  ggtitle(\"Top 10 Dog Time at Shelter by Outcome and Time\") +\n  xlab(\"Outcome\") +\n  ylab(\"Mean Time at Shelter\") +\n  theme(plot.title = element_text(face=\"bold\"),\n        axis.text.x = element_text(angle = 90))\n\n#how to do stacked bar?\n#change to stacked bar -- shows how many in each animal breed had which outcome\ndogs%>%\n  ggplot(aes(x = animal_breed, y = diffTime2, color = outcome_type))+\n  geom_point() +\n  ggtitle(\"Top 10 Dog Time at Shelter by Outcome and Time\") +\n  xlab(\"Outcome\") +\n  ylab(\"Mean Time at Shelter\") +\n  theme(plot.title = element_text(face=\"bold\"),\n        axis.text.x = element_text(angle = 90))\n\n#do analysis on lowest 10 breeds\n#figure out how to pull lowest\n\n#keep\n#count outcome on breed type\noutcomeDat = dallas_dogs %>% \n  group_by(animal_breed)%>%\n  count(outcome_type)\n\n#make stacked bar - number of animals in each category by breed\noutcomeDat %>%\n  ggplot(aes(x = outcome_type, y = n, color = animal_breed))+\n  geom_point()+\n  ggtitle(\"Outcome of Top 10 Breeds\") +\n  xlab(\"Outcome\") +\n  ylab(\"Count of Breed\") +\n  theme(plot.title = element_text(face=\"bold\"),\n        axis.text.x = element_text(angle = 90))\n\n#keep\n#intake condition vs for breeds\nintakeDat = dallas_dogs %>%\n  group_by(animal_breed)%>%\n  count(intake_type)\n\n#the most common reason for intake for each category is due to it being a stray.\n#the second top reason is becase of owner surrender, the fact that these are the top 2 in \n#each breed is surprising. #don't see n defined...possibly need to add back\nintakeDat %>%\n  ggplot(aes(x = animal_breed, y = n, color = intake_type))+\n  geom_point()+\n  ggtitle(\"Outcome of Top 10 Breeds\") +\n  xlab(\"Outcome\") +\n  ylab(\"Count of Breed\") +\n  theme(plot.title = element_text(face=\"bold\"),\n        axis.text.x = element_text(angle = 90))\n\n\n",
    "created" : 1543798083960.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "623558380",
    "id" : "1BBDF4BA",
    "lastKnownWriteTime" : 1543798050,
    "last_content_update" : 1543798050,
    "path" : "C:/Users/abrown_17/Downloads/statfin1.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}